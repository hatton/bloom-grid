<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>CSS-Grid Requirements Demo</title>

    <style>
      /* ---------- Global defaults (tier‑1) ---------- */
      :root {
        /* default look for every <div class="cell"> unless overridden */
        --cell-bg: #fff; /* white background */
        --cell-padding: 8px 10px; /* roomy text padding */
        --cell-border-width: 1px; /* 1 px hairlines */
        --cell-border-color: #444; /* dark grey stroke */
      }

      /* ---------------- Base page styling ---------------- */
      body {
        font-family: Arial, sans-serif;
        margin: 24px;
      }
      h1 {
        font-size: 1.35rem;
        margin-bottom: 1rem;
      }

      /* ---------- Core layout utilities (value‑agnostic) ---------- */
      .grid {
        display: grid;
        gap: var(--gap, 0);
        background: var(--bg, transparent);

        /* grid-template-columns and -rows injected by JS */
      }

      .cell {
        /* Tier‑2: inherit (or override) from the parent .grid */
        background: var(--cell-bg);
        padding: var(--cell-padding);
        outline: var(--cell-border-width) solid var(--cell-border-color);

        /* Tier‑3: this individual cell can override via inline vars */
        background: var(--this-bg, var(--cell-bg));
        padding: var(--this-padding, var(--cell-padding));

        grid-column: span var(--span-x, 1);
        grid-row: span var(--span-y, 1);
      }

      /* --- NEW RULE --- */
      /* A skipped cell is one that is logically "covered" by
         a previous cell's row or column span. We hide it
         completely so the grid layout ignores it. */
      .cell.skip {
        display: none;
      }

      [contenteditable]:focus {
        outline: none; /* Removes the border completely */
      }
    </style>
    <script type="importmap">
      {
        "imports": {
          "react/": "https://esm.sh/react@^19.1.0/",
          "react": "https://esm.sh/react@^19.1.0",
          "react-dom/": "https://esm.sh/react-dom@^19.1.0/"
        }
      }
    </script>
    <script type="module" src="/src/grid-observer.ts"></script>
  </head>
  <body style="background: rgb(61, 61, 61); padding: 10px">
    <div id="controls-root" class="mt-8"></div>
    <br />
    <div
      id="page"
      style="background: white; padding: 10px; height: 800px; width: 600px"
    >
      <div
        id="main-grid"
        class="grid"
        data-column-widths="fill"
        data-row-heights="fit,fit,fit,fit"
        style="
          height: 100%;
          --bg: #ffffff; /* if we see this, it means our cell counts are off */
          --border-color: red; /* no border on the main grid */

          --gap: 1px;
          /* Tier‑2: give all outer‑grid cells a light orange bg & tighter padding */
          --cell-bg: transparent;
          --cell-padding: 6px 8px; /* slightly tighter */
          /*--cell-border-color: #ecf0f6;*/
        "
      >
        <!-- ---------- Row 1 ---------- -->
        <div class="cell">
          <div contenteditable="true">
            <h1>A heading</h1>
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do
              eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
              enim ad minim veniam, quis nostrud exercitation ullamco laboris
              nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in
              reprehenderit in voluptate velit esse cillum dolore eu fugiat
              nulla pariatur. Excepteur sint occaecat cupidatat non proident,
              sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>
          </div>
        </div>

        <!-- ---------- Row 2 ---------- -->
        <div class="cell">
          <div
            class="grid"
            data-column-widths="fill,fill"
            data-row-heights="fit,fit"
            style="--border-color: green; --cell-border-width: 1px"
          >
            <!-- Row 2.1 -->
            <div class="cell"><div contenteditable="true">A</div></div>
            <div class="cell"><div contenteditable="true">B</div></div>
            <!-- Row 2.2 -->
            <div class="cell" style="--span-x: 2">
              <div contenteditable="true">Spanning nested cell</div>
            </div>
            <!-- This cell is present in the DOM for logical consistency,
                 but hidden from layout because the cell to the left of it spans 2 columns. -->
            <div class="cell skip"><div contenteditable="true"></div></div>
          </div>
        </div>

        <!-- ---------- Row 3 (fill) ---------- -->
        <div class="cell">
          <div
            class="grid"
            data-column-widths="fit,fit,fit"
            data-row-heights="fit,fit"
            style="
              --cell-border-color: black;
              --cell-border-width: 1px;
              margin-left: auto;
              margin-right: auto;
              width: fit-content;
            "
          >
            <!-- Row 3.1 -->
            <div class="cell"><div contenteditable="true">l</div></div>
            <div class="cell"><div contenteditable="true">a</div></div>
            <div class="cell"><div contenteditable="true">m</div></div>
            <!-- Row 3.2 -->
            <div class="cell"><div contenteditable="true">i</div></div>
            <div class="cell"><div contenteditable="true">p</div></div>
            <div class="cell"><div contenteditable="true">i</div></div>
          </div>
        </div>

        <!-- ---------- Row 4 (default fit) ---------- -->
        <div class="cell">
          <div contenteditable="true">Papa i salim mama smapim lip.</div>
        </div>
      </div>
    </div>

    <script type="module" src="/src/index.tsx"></script>
  </body>
</html>
